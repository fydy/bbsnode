{"version":3,"sources":["node_modules/nodebb-plugin-composer-default/static/lib/composer/categoryList.js"],"names":["define","categorySelector","categoryList","selector","init","postContainer","postData","listContainer","find","length","on","toggleDropDirection","socket","emit","err","categories","app","alertError","message","forEach","category","disabledClass","$","cid","name","translateText","appendTo","parseAndTranslate","pullRight","html","append","selectedCategory","hasOwnProperty","changeCategory","parseInt","this","attr","trigger","selectCategory","getSelectedCategory","addClass","text","removeClass","selectedCid","toggleClass","outerHeight","window","height","getSelectedCid","require","tags","onChangeCategory"],"mappings":"AACA,aAIAA,OAAO,yBAA0B,oBAAqB,SAASC,GAC9D,IAAIC,KAEJ,IAAIC,EAEJD,EAAaE,KAAO,SAASC,EAAeC,GAC3C,IAAIC,EAAgBF,EAAcG,KAAK,4BACvC,IAAKD,EAAcE,OAAQ,CAC1B,OAGDJ,EAAcK,GAAG,yBAA0B,WAC1CC,EAAoBN,KAGrBO,OAAOC,KAAK,6CAA+C,SAASC,EAAKC,GACxE,GAAID,EAAK,CACR,OAAOE,IAAIC,WAAWH,EAAII,SAG3BH,EAAWI,QAAQ,SAAUC,GAC5B,IAAKA,EAASC,cAAe,CAC5BC,EAAE,iBAAmBF,EAASG,IAAM,KAAOH,EAASI,KAAO,SAASC,cAAcL,EAASI,MAAME,SAASJ,EAAE,0BAI9GN,IAAIW,kBAAkB,8BACrBZ,WAAYA,EACZa,UAAW,MACT,SAAUC,GACZtB,EAAcuB,OAAOD,GACrB1B,EAAWF,EAAiBG,KAAKG,EAAcC,KAAK,mCAAoC,SAAUuB,GACjG,GAAIzB,EAAS0B,eAAe,OAAQ,CACnCC,EAAe5B,EAAeC,EAAUyB,EAAiBR,KAG1DD,EAAE,cAAgBY,SAASZ,EAAEa,MAAMC,KAAK,YAAa,IAAM,GAAK,KAAKC,QAAQ,WAG9E,GAAI/B,EAASiB,IAAK,CACjBpB,EAASmC,eAAehC,EAASiB,KAGlC,IAAIQ,EAAmB5B,EAASoC,sBAEhCjB,EAAE,kBAAkBG,cAAcM,EAAmBA,EAAiBP,KAAO,wCAC7EF,EAAE,sBAAsBd,KAAK,gBAAkBF,EAASiB,IAAM,MAAMiB,SAAS,UAE7E7B,EAAoBN,OAKtBiB,EAAE,sBAAsBZ,GAAG,QAAS,KAAM,WACzCY,EAAE,kBAAkBmB,KAAKnB,EAAEa,MAAMM,QACjCnB,EAAE,sBAAsBoB,YAAY,QACpCpB,EAAE,yBAAyBoB,YAAY,UACvCpB,EAAEa,MAAMK,SAAS,UACjB,IAAIG,EAAcrB,EAAEa,MAAMC,KAAK,YAC/BjC,EAASmC,eAAeK,GACxB,GAAIrC,EAAS0B,eAAe,OAAQ,CACnCC,EAAe5B,EAAeC,EAAUqC,OAK3C,SAAShC,EAAoBN,GAC5BA,EAAcG,KAAK,4DAA4DoC,YAAY,SAAUvC,EAAcwC,cAAgBvB,EAAEwB,QAAQC,SAAW,GAGzJ7C,EAAa8C,eAAiB,WAC7B,IAAIjB,EACJ,GAAI5B,EAAU,CACb4B,EAAmB5B,EAASoC,sBAE7B,OAAOR,EAAmBA,EAAiBR,IAAM,GAGlD,SAASU,EAAe5B,EAAeC,EAAUiB,GAChDjB,EAASiB,IAAMA,EACf0B,SAAS,iBAAkB,SAAUC,GACpCA,EAAKC,iBAAiB9C,EAAeC,EAAUiB,KAIjD,OAAOrB","file":"node_modules/nodebb-plugin-composer-default/static/lib/composer/categoryList.js","sourcesContent":["\n'use strict';\n\n/*globals define, socket, app*/\n\ndefine('composer/categoryList', ['categorySelector'], function(categorySelector) {\n\tvar categoryList = {};\n\n\tvar selector;\n\n\tcategoryList.init = function(postContainer, postData) {\n\t\tvar listContainer = postContainer.find('.category-list-container');\n\t\tif (!listContainer.length) {\n\t\t\treturn;\n\t\t}\n\n\t\tpostContainer.on('action:composer.resize', function () {\n\t\t\ttoggleDropDirection(postContainer);\n\t\t});\n\n\t\tsocket.emit('plugins.composer.getCategoriesForSelect', {}, function(err, categories) {\n\t\t\tif (err) {\n\t\t\t\treturn app.alertError(err.message);\n\t\t\t}\n\n\t\t\tcategories.forEach(function (category) {\n\t\t\t\tif (!category.disabledClass) {\n\t\t\t\t\t$('<li data-cid=\"' + category.cid + '\">' + category.name + '</li>').translateText(category.name).appendTo($('.category-selector'));\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tapp.parseAndTranslate('partials/category-selector', {\n\t\t\t\tcategories: categories,\n\t\t\t\tpullRight: true\n\t\t\t}, function (html) {\n\t\t\t\tlistContainer.append(html);\n\t\t\t\tselector = categorySelector.init(listContainer.find('[component=\"category-selector\"]'), function (selectedCategory) {\n\t\t\t\t\tif (postData.hasOwnProperty('cid')) {\n\t\t\t\t\t\tchangeCategory(postContainer, postData, selectedCategory.cid);\n\t\t\t\t\t}\n\n\t\t\t\t\t$('[tabindex=' + (parseInt($(this).attr('tabindex'), 10) + 1) + ']').trigger('focus');\n\t\t\t\t});\n\n\t\t\t\tif (postData.cid) {\n\t\t\t\t\tselector.selectCategory(postData.cid);\n\t\t\t\t}\n\n\t\t\t\tvar selectedCategory = selector.getSelectedCategory();\n\n\t\t\t\t$('.category-name').translateText(selectedCategory ? selectedCategory.name : '[[modules:composer.select_category]]');\n\t\t\t\t$('.category-selector').find('li[data-cid=\"' + postData.cid + '\"]').addClass('active');\n\n\t\t\t\ttoggleDropDirection(postContainer);\n\t\t\t});\n\t\t});\n\n\n\t\t$('.category-selector').on('click', 'li', function() {\n\t\t\t$('.category-name').text($(this).text());\n\t\t\t$('.category-selector').removeClass('open');\n\t\t\t$('.category-selector li').removeClass('active');\n\t\t\t$(this).addClass('active');\n\t\t\tvar selectedCid = $(this).attr('data-cid');\n\t\t\tselector.selectCategory(selectedCid);\n\t\t\tif (postData.hasOwnProperty('cid')) {\n\t\t\t\tchangeCategory(postContainer, postData, selectedCid);\n\t\t\t}\n\t\t});\n\t};\n\n\tfunction toggleDropDirection(postContainer) {\n\t\tpostContainer.find('.category-list-container [component=\"category-selector\"]').toggleClass('dropup', postContainer.outerHeight() < $(window).height() / 2);\n\t}\n\n\tcategoryList.getSelectedCid = function () {\n\t\tvar selectedCategory;\n\t\tif (selector) {\n\t\t\tselectedCategory = selector.getSelectedCategory();\n\t\t}\n\t\treturn selectedCategory ? selectedCategory.cid : 0;\n\t};\n\n\tfunction changeCategory(postContainer, postData, cid) {\n\t\tpostData.cid = cid;\n\t\trequire(['composer/tags'], function (tags) {\n\t\t\ttags.onChangeCategory(postContainer, postData, cid);\n\t\t});\n\t}\n\n\treturn categoryList;\n});\n"]}