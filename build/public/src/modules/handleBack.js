"use strict";define("handleBack",["components","storage","navigator","forum/pagination"],function(t,o,e,a){var i={};var n;i.init=function(t){n=t;r();$(window).off("action:popstate",c).on("action:popstate",c)};function r(){$('[component="category"]').on("click",'[component="topic/header"]',function(){var t=$(this).parents("[data-index]").attr("data-index");$('[component="category/topic"]').each(function(e,a){if($(a).offset().top-$(window).scrollTop()>0){o.setItem("category:bookmark",$(a).attr("data-index"));o.setItem("category:bookmark:clicked",t);return false}})})}function c(){if(ajaxify.data.template.category||ajaxify.data.template.recent){var t=o.getItem("category:bookmark");var e=o.getItem("category:bookmark:clicked");o.removeItem("category:bookmark");o.removeItem("category:bookmark:clicked");if(!utils.isNumber(t)){return}t=Math.max(0,parseInt(t,10)||0);e=Math.max(0,parseInt(e,10)||0);if(!t&&!e){return}if(config.usePagination){var r=Math.ceil((parseInt(t,10)+1)/config.topicsPerPage);if(parseInt(r,10)!==ajaxify.data.pagination.currentPage){a.loadPage(r,function(){i.scrollToTopic(t,e)})}else{i.scrollToTopic(t,e)}}else{if(t===0){i.highlightTopic(e);return}$('[component="category"]').empty();n(Math.max(0,t-1)+1,function(){i.scrollToTopic(t,e)})}}}i.highlightTopic=function(o){var e=t.get("category/topic","index",o);if(e.length&&!e.hasClass("highlight")){e.addClass("highlight");setTimeout(function(){e.removeClass("highlight")},5e3)}};i.scrollToTopic=function(o,a){if(!utils.isNumber(o)){return}var n=t.get("category/topic","index",o);if(n.length){$(window).scrollTop(n.offset().top);i.highlightTopic(a);e.update()}};return i});
//# sourceMappingURL=handleBack.js.map