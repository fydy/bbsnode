"use strict";define("forum/account/settings",["forum/account/header","components","sounds","translator"],function(t,a,e,n){var i={};$(window).on("action:ajaxify.start",function(){if(ajaxify.data.template.name==="account/settings"&&$("#bootswatchSkin").val()!==config.bootswatchSkin){app.reskin(config.bootswatchSkin)}});i.init=function(){t.init();$("#submitBtn").on("click",function(){var t=o();if(t.homePageRoute==="custom"&&t.homePageCustom){$.get(config.relative_path+"/"+t.homePageCustom,function(){r(t)}).fail(function(){app.alertError("[[error:invalid-home-page-route]]")})}else{r(t)}return false});$("#bootswatchSkin").on("change",function(){app.reskin($(this).val())});$('[data-property="homePageRoute"]').on("change",s);$(".account").find('button[data-action="play"]').on("click",function(t){t.preventDefault();var a=$(this).parent().parent().find("select").val();e.playSound(a)});s();a.get("user/sessions").find(".timeago").timeago()};function o(){var t={};$(".account").find("input, textarea, select").each(function(a,e){e=$(e);var n=e.attr("data-property");if(e.is("select")){t[n]=e.val();return}switch(e.attr("type")){case"text":case"textarea":t[n]=e.val();break;case"checkbox":t[n]=e.is(":checked")?1:0;break}});return t}function r(t){socket.emit("user.saveSettings",{uid:ajaxify.data.theirid,settings:t},function(t,a){if(t){return app.alertError(t.message)}app.alertSuccess("[[success:settings-saved]]");var i=false;for(var o in a){if(a.hasOwnProperty(o)){if(o==="userLang"&&config.userLang!==a.userLang){i=true}if(config.hasOwnProperty(o)){config[o]=a[o]}}}e.loadMap();if(i&&parseInt(app.user.uid,10)===parseInt(ajaxify.data.theirid,10)){n.translate("[[language:dir]]",config.userLang,function(t){var a=$("html");a.attr("data-dir",t);a.css("direction",t)});ajaxify.refresh()}})}function s(){if($('[data-property="homePageRoute"]').val()==="custom"){$("#homePageCustom").show()}else{$("#homePageCustom").hide();$('[data-property="homePageCustom"]').val("")}}return i});
//# sourceMappingURL=settings.js.map